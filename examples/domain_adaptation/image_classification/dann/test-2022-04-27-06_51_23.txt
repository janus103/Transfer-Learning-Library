Namespace(arch='resnet50', batch_size=16, bottleneck_dim=256, data='ImageNet50', epochs=20, iters_per_epoch=1000, log='dann', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, no_hflip=False, no_pool=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='test', print_freq=100, resize_size=224, root='/data/ImageNet_dataset/v100/jin/', scratch=False, seed=None, source=['IN'], target=['gray-val'], trade_off=1.0, train_resizing='custom.target', val_resizing='custom.target', weight_decay=0.001, workers=2)
train_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
Test: [  0/935]	Time  0.942 ( 0.942)	Loss 9.3435e-01 (9.3435e-01)	Acc@1  75.00 ( 75.00)
Test: [100/935]	Time  0.031 ( 0.055)	Loss 1.5460e+00 (6.5705e-01)	Acc@1  62.50 ( 84.16)
Test: [200/935]	Time  0.074 ( 0.053)	Loss 2.6098e-01 (5.6036e-01)	Acc@1  93.75 ( 86.32)
Test: [300/935]	Time  0.028 ( 0.052)	Loss 1.2374e+00 (5.3677e-01)	Acc@1  68.75 ( 87.27)
Test: [400/935]	Time  0.029 ( 0.051)	Loss 1.7138e+00 (6.3952e-01)	Acc@1  68.75 ( 85.46)
Test: [500/935]	Time  0.023 ( 0.051)	Loss 8.8676e-01 (6.2314e-01)	Acc@1  81.25 ( 85.70)
Test: [600/935]	Time  0.097 ( 0.051)	Loss 2.2772e-02 (5.9851e-01)	Acc@1 100.00 ( 86.21)
Test: [700/935]	Time  0.022 ( 0.051)	Loss 1.1222e-01 (5.5761e-01)	Acc@1  93.75 ( 87.09)
Test: [800/935]	Time  0.053 ( 0.050)	Loss 3.4995e-01 (5.3334e-01)	Acc@1  81.25 ( 87.56)
Test: [900/935]	Time  0.068 ( 0.050)	Loss 3.3862e-01 (5.2439e-01)	Acc@1  93.75 ( 87.83)
 * Acc@1 88.120
88.12040133779264
