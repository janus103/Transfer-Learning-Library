Namespace(arch='resnet50', batch_size=16, bottleneck_dim=256, data='ImageNet50', epochs=20, iters_per_epoch=1000, log='dann', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, no_hflip=False, no_pool=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='test', print_freq=100, resize_size=224, root='/data/ImageNet_dataset/v100/jin/', scratch=False, seed=None, source=['IN'], target=['gray'], trade_off=1.0, train_resizing='custom.target', val_resizing='custom.target', weight_decay=0.001, workers=2)
train_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
Test: [   0/3129]	Time  0.901 ( 0.901)	Loss 6.0910e-03 (6.0910e-03)	Acc@1 100.00 (100.00)
Test: [ 100/3129]	Time  0.024 ( 0.049)	Loss 1.6769e-02 (1.6810e-01)	Acc@1 100.00 ( 95.24)
Test: [ 200/3129]	Time  0.022 ( 0.045)	Loss 5.8921e-03 (1.4354e-01)	Acc@1 100.00 ( 96.05)
Test: [ 300/3129]	Time  0.023 ( 0.043)	Loss 7.7817e-01 (1.8126e-01)	Acc@1  87.50 ( 95.39)
Test: [ 400/3129]	Time  0.040 ( 0.041)	Loss 3.7963e-02 (2.0346e-01)	Acc@1 100.00 ( 95.18)
Test: [ 500/3129]	Time  0.047 ( 0.041)	Loss 7.5239e-03 (1.8838e-01)	Acc@1 100.00 ( 95.52)
Test: [ 600/3129]	Time  0.042 ( 0.040)	Loss 6.4322e-03 (1.8070e-01)	Acc@1 100.00 ( 95.57)
Test: [ 700/3129]	Time  0.024 ( 0.040)	Loss 3.5520e-01 (1.6790e-01)	Acc@1  93.75 ( 95.87)
Test: [ 800/3129]	Time  0.025 ( 0.040)	Loss 1.4037e-02 (1.7070e-01)	Acc@1 100.00 ( 95.84)
Test: [ 900/3129]	Time  0.042 ( 0.040)	Loss 4.1416e-01 (1.6819e-01)	Acc@1  93.75 ( 95.89)
Test: [1000/3129]	Time  0.050 ( 0.040)	Loss 1.1831e-01 (1.6085e-01)	Acc@1  93.75 ( 96.07)
Test: [1100/3129]	Time  0.022 ( 0.040)	Loss 5.5380e-01 (1.8502e-01)	Acc@1  81.25 ( 95.41)
Test: [1200/3129]	Time  0.046 ( 0.039)	Loss 4.3404e-03 (1.9007e-01)	Acc@1 100.00 ( 95.24)
Test: [1300/3129]	Time  0.048 ( 0.040)	Loss 1.7843e-01 (1.8968e-01)	Acc@1  93.75 ( 95.25)
Test: [1400/3129]	Time  0.024 ( 0.040)	Loss 7.1795e-03 (1.9169e-01)	Acc@1 100.00 ( 95.22)
Test: [1500/3129]	Time  0.024 ( 0.040)	Loss 1.3879e-01 (1.8747e-01)	Acc@1  93.75 ( 95.31)
Test: [1600/3129]	Time  0.045 ( 0.040)	Loss 3.0726e-02 (1.8489e-01)	Acc@1 100.00 ( 95.40)
Test: [1700/3129]	Time  0.024 ( 0.039)	Loss 9.5819e-01 (1.8967e-01)	Acc@1  75.00 ( 95.34)
Test: [1800/3129]	Time  0.023 ( 0.039)	Loss 4.9694e-01 (1.9952e-01)	Acc@1  87.50 ( 95.13)
Test: [1900/3129]	Time  0.034 ( 0.039)	Loss 1.3852e-02 (1.9511e-01)	Acc@1 100.00 ( 95.23)
Test: [2000/3129]	Time  0.024 ( 0.039)	Loss 1.1183e-02 (1.8954e-01)	Acc@1 100.00 ( 95.35)
Test: [2100/3129]	Time  0.057 ( 0.039)	Loss 4.0761e-03 (1.8271e-01)	Acc@1 100.00 ( 95.52)
Test: [2200/3129]	Time  0.023 ( 0.039)	Loss 5.9895e-03 (1.7731e-01)	Acc@1 100.00 ( 95.65)
Test: [2300/3129]	Time  0.045 ( 0.039)	Loss 1.5334e-02 (1.7278e-01)	Acc@1 100.00 ( 95.77)
Test: [2400/3129]	Time  0.032 ( 0.039)	Loss 6.9879e-02 (1.7166e-01)	Acc@1 100.00 ( 95.80)
Test: [2500/3129]	Time  0.047 ( 0.039)	Loss 7.7288e-02 (1.6696e-01)	Acc@1 100.00 ( 95.90)
Test: [2600/3129]	Time  0.027 ( 0.039)	Loss 2.0730e-01 (1.6468e-01)	Acc@1  93.75 ( 95.94)
Test: [2700/3129]	Time  0.023 ( 0.039)	Loss 6.9054e-02 (1.6452e-01)	Acc@1  93.75 ( 95.96)
Test: [2800/3129]	Time  0.029 ( 0.039)	Loss 3.8577e-03 (1.6271e-01)	Acc@1 100.00 ( 96.01)
Test: [2900/3129]	Time  0.044 ( 0.039)	Loss 1.3909e-03 (1.5919e-01)	Acc@1 100.00 ( 96.10)
Test: [3000/3129]	Time  0.043 ( 0.039)	Loss 2.3531e-02 (1.6107e-01)	Acc@1 100.00 ( 96.06)
Test: [3100/3129]	Time  0.055 ( 0.040)	Loss 3.5211e-03 (1.5755e-01)	Acc@1 100.00 ( 96.14)
 * Acc@1 96.158
96.15784215784215
