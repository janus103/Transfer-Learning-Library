Namespace(arch='resnet50', batch_size=16, bottleneck_dim=256, data='ImageNet50', epochs=20, iters_per_epoch=1000, log='dann', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, no_hflip=False, no_pool=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='test', print_freq=100, resize_size=224, root='/data/ImageNet_dataset/v100/jin/', scratch=False, seed=None, source=['IN'], target=['IN'], trade_off=1.0, train_resizing='custom.target', val_resizing='custom.target', weight_decay=0.001, workers=2)
train_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(224, 224))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
Test: [   0/3129]	Time  0.860 ( 0.860)	Loss 4.6115e-03 (4.6115e-03)	Acc@1 100.00 (100.00)
Test: [ 100/3129]	Time  0.024 ( 0.067)	Loss 9.8016e-03 (1.2714e-02)	Acc@1 100.00 ( 99.69)
Test: [ 200/3129]	Time  0.023 ( 0.062)	Loss 7.1930e-03 (1.2016e-02)	Acc@1 100.00 ( 99.66)
Test: [ 300/3129]	Time  0.023 ( 0.061)	Loss 7.4164e-03 (1.0266e-02)	Acc@1 100.00 ( 99.75)
Test: [ 400/3129]	Time  0.035 ( 0.059)	Loss 8.4295e-03 (1.1051e-02)	Acc@1 100.00 ( 99.72)
Test: [ 500/3129]	Time  0.087 ( 0.058)	Loss 2.2911e-03 (1.0118e-02)	Acc@1 100.00 ( 99.74)
Test: [ 600/3129]	Time  0.023 ( 0.057)	Loss 5.5892e-03 (9.4289e-03)	Acc@1 100.00 ( 99.77)
Test: [ 700/3129]	Time  0.023 ( 0.058)	Loss 3.5708e-03 (8.8420e-03)	Acc@1 100.00 ( 99.80)
Test: [ 800/3129]	Time  0.023 ( 0.058)	Loss 5.2212e-03 (8.4388e-03)	Acc@1 100.00 ( 99.83)
Test: [ 900/3129]	Time  0.078 ( 0.057)	Loss 1.2803e-03 (7.9656e-03)	Acc@1 100.00 ( 99.85)
Test: [1000/3129]	Time  0.069 ( 0.058)	Loss 8.2968e-02 (7.7890e-03)	Acc@1 100.00 ( 99.85)
Test: [1100/3129]	Time  0.023 ( 0.058)	Loss 1.0371e-02 (9.0848e-03)	Acc@1 100.00 ( 99.78)
Test: [1200/3129]	Time  0.077 ( 0.058)	Loss 2.9280e-03 (9.5250e-03)	Acc@1 100.00 ( 99.77)
Test: [1300/3129]	Time  0.092 ( 0.059)	Loss 3.2134e-03 (9.1283e-03)	Acc@1 100.00 ( 99.78)
Test: [1400/3129]	Time  0.075 ( 0.058)	Loss 2.8514e-03 (8.8277e-03)	Acc@1 100.00 ( 99.79)
Test: [1500/3129]	Time  0.023 ( 0.058)	Loss 5.2298e-03 (8.5444e-03)	Acc@1 100.00 ( 99.81)
Test: [1600/3129]	Time  0.078 ( 0.058)	Loss 1.3191e-03 (8.3388e-03)	Acc@1 100.00 ( 99.82)
Test: [1700/3129]	Time  0.136 ( 0.058)	Loss 9.7394e-03 (8.2121e-03)	Acc@1 100.00 ( 99.83)
Test: [1800/3129]	Time  0.023 ( 0.058)	Loss 9.1687e-03 (8.5755e-03)	Acc@1 100.00 ( 99.81)
Test: [1900/3129]	Time  0.023 ( 0.058)	Loss 5.2167e-03 (8.5698e-03)	Acc@1 100.00 ( 99.80)
Test: [2000/3129]	Time  0.098 ( 0.058)	Loss 5.9054e-03 (8.2978e-03)	Acc@1 100.00 ( 99.81)
Test: [2100/3129]	Time  0.025 ( 0.058)	Loss 3.5117e-03 (8.0997e-03)	Acc@1 100.00 ( 99.82)
Test: [2200/3129]	Time  0.023 ( 0.058)	Loss 6.5083e-03 (7.9417e-03)	Acc@1 100.00 ( 99.82)
Test: [2300/3129]	Time  0.077 ( 0.058)	Loss 3.9967e-03 (7.7816e-03)	Acc@1 100.00 ( 99.83)
Test: [2400/3129]	Time  0.024 ( 0.058)	Loss 4.3478e-03 (7.7777e-03)	Acc@1 100.00 ( 99.84)
Test: [2500/3129]	Time  0.081 ( 0.058)	Loss 3.3973e-03 (7.7499e-03)	Acc@1 100.00 ( 99.84)
Test: [2600/3129]	Time  0.029 ( 0.058)	Loss 2.7945e-03 (7.5772e-03)	Acc@1 100.00 ( 99.85)
Test: [2700/3129]	Time  0.023 ( 0.058)	Loss 3.0629e-03 (7.5291e-03)	Acc@1 100.00 ( 99.85)
Test: [2800/3129]	Time  0.078 ( 0.058)	Loss 3.6523e-03 (7.3892e-03)	Acc@1 100.00 ( 99.86)
Test: [2900/3129]	Time  0.103 ( 0.058)	Loss 2.3569e-03 (7.3485e-03)	Acc@1 100.00 ( 99.86)
Test: [3000/3129]	Time  0.060 ( 0.058)	Loss 4.0471e-03 (7.2898e-03)	Acc@1 100.00 ( 99.87)
Test: [3100/3129]	Time  0.098 ( 0.058)	Loss 3.1866e-03 (7.1683e-03)	Acc@1 100.00 ( 99.87)
 * Acc@1 99.874
99.87412587412588
